# 组件配置

## 发布订阅

边车启动初始化时，首先会去调用应用的 `/dapr/subscribe` 方法获取应用是否有监听分布式事件，如有则注册到边车之中。

### Kafka

#### 问题一

`1195725856 is GET[space] encoded as a big-endian, four-byte integer (see here for more information on how that works). This indicates that HTTP traffic is being sent to Kafka port 9092, but Kafka doesn't accept HTTP traffic, it only accepts its own protocol (which takes the first four bytes as the receive size, hence the error).`

#### 问题二 dapr显示无法连接到kafka（is your cluster reachable?）

需要配置好地址。

项目`Rebuild`后可能是`Dapr`开的比较快，而`Kafka`还没起来，导致以为连不上。第二次再启动就行了。

#### 问题三Message was too large, server rejected it to avoid allocation error when using Headers

```yaml
- name: maxMessageBytes
  value: 10485760000
```

配置弄大点？

注意`Dapr`这些`component`的`yaml`配置文件需要`Rebuild`才会生效

#### 问题四 无法从外部连接kafka，dapr访问地址将自动变为内部集群ip

`Kafka`需配置外部访问监听地址：[Kafka Listeners - Explained](https://rmoff.net/2018/08/02/kafka-listeners-explained/)

## 可访问性

A namespaced component is only accessible to applications running in the same namespace. If your Dapr application fails to load a component, make sure that the application namespace matches the component namespace. This can be especially tricky in self-hosted mode where the application namespace is stored in a NAMESPACE environment variable.

![Text Description automatically generated](../attachments/eb53443be9ac1949d4fe75a7c14a00cf.png)

## HTTPS

![](../attachments/93c193a54966473bc2f80eab21e72c3a.png)

If you leave the Configure for HTTPS checkbox checked, the generated ASP.NET Core API project includes middleware to redirect client requests to the HTTPS endpoint. This breaks communication between the Dapr sidecar and your application, unless you explicitly configure the use of HTTPS when running your Dapr application. To enable the Dapr sidecar to communicate over HTTPS, include the `--app-ssl` flag in the Dapr command to start the application. Also specify the HTTPS port using the `--app-port` parameter. The remainder of this walkthrough uses plain HTTP communication between the sidecar and the application, and requires you to clear the Configure for HTTPS checkbox.

## 状态存储

Care must be taken to always pass an explicit app-id parameter when consuming the state management building block. The block uses the application id value as a prefix for its state key for each key/value pair. If the application id changes, you can no longer access the previously stored state.